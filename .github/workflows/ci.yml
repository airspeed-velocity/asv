name: CI

on: [push, pull_request]

jobs:
  build:
    uses: OpenAstronomy/github-actions-workflows/.github/workflows/tox.yml@v1
    with:
      envs: |
        - linux: build-dist
        - linux: build-docs
  test:
    uses: OpenAstronomy/github-actions-workflows/.github/workflows/tox.yml@main
    with:
      envs: |
        - linux: test-mindeps-xdist
          python-version: "3.7"
        - linux: test-xdist
          python-version: "3.7"
        - linux: test-xdist
          python-version: "pypy3.7"
        - linux: test-xdist
          python-version: "pypy3.8"
        - linux: test-xdist
          python-version: "3.10"
        - linux: test-xdist
          python-version: "3.11"
        - macos: test-xdist
          python-version: "3.11"
        - linux: test-devdeps-xdist
        - linux: test-xdist-cov
          coverage: codecov
